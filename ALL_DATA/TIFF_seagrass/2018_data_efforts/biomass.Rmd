---
title: "Untitled"
author: "Tiff Stephens"
date: "11/6/2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


---
title: "An investigation of sea otter disturbance in seagrass habitat"
author: "Tiff Stephens + Maggie Shields + team"
date: "10/19/2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

#theme_set(theme_classic())
#theme_set(theme_cowplot(font_size=12))
```

```{r}
library(leaflet)
library(htmlwidgets)
library(htmltools)
library(reshape)
library(reshape2)
library(dplyr)
library(plyr)
library(tidyr)
library(ggplot2)
library(plotly)
library(lubridate)
library(DT)
library(shiny)
library(mapview)
library(sp)
library(sf)
library(knitr)
library(cowplot)
library(ggpmisc)
library(DT)
library(magick)
library(mgcv)
```


```{r}
sgmass <- read.csv("/Users/tiff/Desktop/R Studio/APECS-master-repos/ALL_DATA/TIFF_seagrass/2018_data_efforts/biomass_aggregate.csv", stringsAsFactors = FALSE, header = TRUE)

sgmass <- sgmass %>%
  mutate(leaf.rhizome = leaf / rhizome)
```

```{r}
linear.model <- (y ~ x)
poly.model <- y ~ poly(x,2)

pz4 = ggplot(sgmass, aes(sea_otter_index, leaf)) +
  geom_point(size=3) + # allows for trendline on general trend
  geom_smooth(method=lm, formula=y ~ poly(x,2), se=FALSE, fullrange=FALSE) +
  #geom_smooth(method=lm, formula= y ~ x, se=FALSE, fullrange=FALSE) +
  #geom_smooth(method=lm, formula = -(log(y) ~ x), se=FALSE, fullrange=FALSE) +
  #xlab("Sea Otter Index")+ylab("Diffuse edge elevation (cm, MLLW)") +
  #theme(legend.title=element_text(size=8), legend.text=element_text(size=8)) +
  geom_text(aes(label=site), size=2)
  stat_poly_eq(formula = poly.model, 
               aes(label = paste(..rr.label.., sep = "~~~")), 
               label.x.npc = 'right', label.y.npc = 'top', size = 5, parse = TRUE) +
  stat_fit_glance(method = 'lm', method.args = list(formula = poly.model), geom = 'text',
                  aes(label = paste("P-value = ", signif(..p.value.., digits = 3), sep = "")),
                  label.x.npc = 'left', label.y.npc = 'top', size = 5)
plot(pz4)
```


