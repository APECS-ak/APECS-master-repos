---
title: "ETR_data_exploration_2018"
author: "Wendel Raymond"
date: "October 9, 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

# Eelgrass community trophic relationships (ETR) data exploration
Here I will conduct exploratory analysis of 2018 eelgrass community data

```{r libraries, echo = FALSE, warning=FALSE, message = FALSE}
library(dplyr)
library(ggplot2)
library(DT)
library(cowplot)
library(RColorBrewer)
library(vegan)

theme_set(theme_classic())
```

## Load data
Load biomass/abundace data, stable isotope, and fatty acid data

Biomass and oceanography
```{r dat bio, echo=FALSE}
eg <- read.csv("../ALL_DATA/Eelgrass_biometrics_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)

crb <- read.csv("../ALL_DATA/crab_simple_site_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)

crb.sp <- read.csv("../ALL_DATA/crab_site_sp_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)

crb.all <- read.csv("../ALL_DATA/Crab_pots_2018_RAW.csv", stringsAsFactors = FALSE, header = TRUE)

clm <- read.csv("../ALL_DATA/eelgrass_clam_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)

clm.sp <- read.csv("../ALL_DATA/eelgrass_clam_site_sp_2018.csv", header = TRUE, stringsAsFactors = FALSE)

fsh <- read.csv("../ALL_DATA/Fish_mass_site_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)

pom <- read.csv("../ALL_DATA/POM_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)

oce <- read.csv("../ALL_DATA/Site_oceanography_2018_RAW.csv", header = TRUE, stringsAsFactors = FALSE)
```

Stable Isotope - preliminary
```{r dat iso, echo = FALSE}
si <- read.csv("E:/wraymond2/My Documents/Graduate School/Eelgrass/Eelgrass trophic relationships/Data/SI_prelim_2018.csv", header = TRUE, stringsAsFactors = FALSE)
```

Fatty Acid
```{r dat fa, echo = FALSE}
fa_0.5 <- read.csv("../ALL_DATA/FA_proportions_0.5filter_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)

fa_1.0 <- read.csv("../ALL_DATA/FA_proportions_1.0filter_2018_derived.csv", header = TRUE, stringsAsFactors = FALSE)
```

Biomarker metadata
```{r dat biomarker, echo = FALSE}
bimrk <- read.csv("../ALL_DATA/Biomarker_collections_2018_RAW.csv", header = TRUE, stringsAsFactors = FALSE)
```

### Biomarker metadata
Extract metadata on samples. N pooled, size, etc.
```{r biomarker sum, echo = FALSE}
## Filter out ones that I actualy processed all the way ##
bimrk_redu <- bimrk %>%
  filter(Biomarker_ID %in% fa_1.0$ID)
```


### Complie biomass data
Merge all the different biomass data types into one data frame
```{r merge, echo = FALSE}
dat <- merge(eg, crb, by = c("site", "place_name"), all.x = TRUE)
dat <- merge(dat, clm[, c(1, 5:13)], by = "site")
dat <- merge(dat, fsh, by = "site")
dat <- merge(dat, oce[, c(1, 6:19)], by = "site")
```

## Data exploration
### Biomass
```{r exp plots, echo = FALSE}
## Eelgrass mass ##
ggplot(dat) +
  geom_col(aes(x = site, y  = eg_shoot_mass_m)) +
  geom_errorbar(aes(x = site, ymin = eg_shoot_mass_m - eg_shoot_mass_m_se, ymax = eg_shoot_mass_m + eg_shoot_mass_m_se), width = 0) +
  labs(x = "Site", y = "Eelgrass shoot mass (g/m2)")

## Macroalgae cover ##
ggplot(dat) +
  geom_col(aes(x = site, y  = macro_cover)) +
  geom_errorbar(aes(x = site, ymin = macro_cover - macro_cover_se, ymax = macro_cover + macro_cover_se), width = 0) +
  labs(x = "Site", y = "Macroalgae % cover")

## Diatom cover ##
ggplot(dat) +
  geom_col(aes(x = site, y  = diatom_cover)) +
  geom_errorbar(aes(x = site, ymin = diatom_cover - diatom_cover_se, ymax = diatom_cover + diatom_cover_se), width = 0) +
  labs(x = "Site", y = "Diatom % cover")

## Epiphyte load ##
ggplot(dat) +
  geom_col(aes(x = site, y  = epiph_load)) +
  geom_errorbar(aes(x = site, ymin = epiph_load - epiph_load_se, ymax = epiph_load + epiph_load_se), width = 0) +
  labs(x = "Site", y = "Epiphyte load (g/g eelgrass)")

## Grazer load ##
ggplot(dat) +
  geom_col(aes(x = site, y  = graz_load)) +
  geom_errorbar(aes(x = site, ymin = graz_load - graz_load_se, ymax = graz_load + graz_load_se), width = 0) +
  labs(x = "Site", y = "Grazer load (g/g eelgrass)")

## Idotea load ##
ggplot(dat) +
  geom_col(aes(x = site, y  = ido_load)) +
  geom_errorbar(aes(x = site, ymin = ido_load - ido_load_se, ymax = ido_load + ido_load_se), width = 0) +
  labs(x = "Site", y = "Idotea load (g/g eelgrass)")

## Limpet load ##
ggplot(dat) +
  geom_col(aes(x = site, y  = limp_load)) +
  geom_errorbar(aes(x = site, ymin = limp_load - limp_load_se, ymax = limp_load + limp_load_se), width = 0) +
  labs(x = "Site", y = "Limpet load (g/g eelgrass)")

## Clam mass ##
ggplot(dat) +
  geom_col(aes(x = site, y  = clm_mass_m)) +
  geom_errorbar(aes(x = site, ymin = clm_mass_m - clm_mass_m_se, ymax = clm_mass_m + clm_mass_m_se), width = 0) +
  labs(x = "Site", y = "Clam mass (g/m2)")

## Clam species ##
ggplot(clm.sp, aes(x = site, y = mass, fill = sp_code)) +
  geom_bar(position = position_dodge(), stat = "identity") +
  geom_errorbar(aes(ymin = mass - mass_se, ymax = mass + mass_se), width = 0, position=position_dodge(0.9)) +
  labs(x = "Site", y = "Clam mass (g/m2)")

## Crab mass ##
ggplot(dat) +
  geom_col(aes(x = site, y = crab_mass)) +
  geom_errorbar(aes(x = site, ymin = crab_mass - crab_mass_se, ymax = crab_mass + crab_mass_se, width = 0)) +
  labs(x = "Site", y = "Crab mass (g/string)")

## Crab species mass ##
ggplot(crb.sp, aes(x = site, y = mass, fill = sp_code)) +
  geom_bar(position = position_dodge(), stat = "identity") +
  geom_errorbar(aes(ymin = mass - mass_se, ymax = mass + mass_se), width = 0, position=position_dodge(0.9)) +
  labs(x = "Site", y = "Crab mass (g/string)")

## All Fish ##
ggplot(dat) +
  geom_col(aes(x = site, y = total_fish_mass / 1000)) +
  labs(x = "Site", y = "Fish mass (kg/site)")

## Shiner Perch ##
ggplot(dat) +
  geom_col(aes(x = site, y = PERCHSH / total_fish_mass)) +
  labs(x = "Site", y = "Proportion shiner perch mass")

## Staghorn Sculpin ##
ggplot(dat) +
  geom_col(aes(x = site, y = SCULPSTG / total_fish_mass)) +
  labs(x = "Site", y = "Proportion staghorn mass")

## Snake prickleback ##
ggplot(dat) +
  geom_col(aes(x = site, y = PRICKSN / total_fish_mass)) +
  labs(x = "Site", y = "Proportion snake prickleback mass")
```

### Size frequency
Size-frequency distributions of crabs and fishes
```{r size-fq, echo = FALSE}
crb.all <- crb.all %>% 
  filter(taxon == "Decapoda")

ggplot(crb.all) +
  geom_histogram(aes(carapace_width_mm)) +
  facet_grid(cols = vars(species_common), rows = vars(place_name))
```

### Particulate Organic Matter
summaries by site
```{r pom data, echo = FALSE}
pom_sum <- pom %>%
  group_by(site) %>% 
  summarise(POM_org_mass_mean = mean(POM_org_mass),
            POM_org_mass_se = sd(POM_org_mass) / sqrt(length(POM_org_mass)),
            POM_inorg_mass_mean = mean(POM_inorg_mass),
            POM_inorg_mass_se = sd(POM_inorg_mass) / sqrt(length(POM_inorg_mass)))
```

```{r plots, echo = FALSE}
## POM organic mass ##
ggplot(pom_sum) +
  geom_col(aes(x = site, y  = POM_org_mass_mean)) +
  geom_errorbar(aes(x = site, ymin = POM_org_mass_mean - POM_org_mass_se, ymax = POM_org_mass_mean + POM_org_mass_se), width = 0) +
  labs(x = "Site", y = "POM organic mass (g/100ml)")

## POM inorganic mass ##
ggplot(pom_sum) +
  geom_col(aes(x = site, y  = POM_inorg_mass_mean)) +
  geom_errorbar(aes(x = site, ymin = POM_inorg_mass_mean - POM_inorg_mass_se, ymax = POM_inorg_mass_mean + POM_inorg_mass_se), width = 0) +
  labs(x = "Site", y = "POM inorganic mass (g/100ml)")
```


### Oceanography
```{r oce, echo = FALSE}
ggplot(dat) +
  geom_col(aes(x = site, y = X1m_temp_C))

ggplot(dat) +
  geom_col(aes(x = site, y = X5m_temp_C))
```


### Stable Isotopes

#### SI data prep
Merge species with si values
```{r si, echo = FALSE}
si <- merge(si, bimrk, by = "Biomarker_ID", all.x = TRUE)
si$Species_common <- factor(si$Species_common, levels = c("Shiner perch", "Snake prickleback", "Staghorn sculpin", "Dungeness crab", "Helmet crab", "Red rock crab", "Dock shrimp", "Macoma sp.", "Bentnose Macoma", "Pointed Macoma", "Butter clam", "Idotea", "Limpet", "Eelgrass", "Eelgrass diatoms", "Fucus", "Particulate organic matter", "Sugar kelp", "Ulva"))
```

#### SI Plots
```{r si plots, echo = FALSE}
pal <- colorRampPalette(brewer.pal(9, "Paired"))

ggplot(si) +
  geom_point(aes(x = del_C, y = del_N, color = Species_common, shape = Species_common), size = 3) +
  scale_color_manual(values = pal(19))+
  scale_shape_manual(values = rep(c(15:19), 4)) +
  scale_y_continuous(limits = c(10, 14)) +
  scale_x_continuous(limits = c(-20, -7))

ggplot(si) +
  geom_point(aes(x = del_C, y = del_N, color = Sea_otter_region), size = 3)

si.limp <- filter(si, Species_common == "Limpet")

ggplot(si.limp) +
  geom_point(aes(x = del_C, y = del_N, color = Collection_Date), size = 3)
```

### Fatty acids
The ultimate goal will be to look at some basic nmds plots of all species. Then overlay some depended variables like site and sea otter treatment.

#### Examine FAs
What FAs do we have here.
```{r fa names, echo = FALSE}
FA_names <- colnames(fa_1.0[,3:67])
FA_names
```


First will will have to prep that data with some manipulations and transformations and standardizations.

#### Transformations and standardizations
Subsets
```{r subset, echo = FALSE}
## Aminals ##
fa_anm_1.0 <- fa_1.0 %>% 
  filter(Species_common != "Eelgrass" & Species_common != "Eelgrass diatoms" & Species_common != "Fucus" & Species_common != "Particulate organic matter" & Species_common != "Sugar kelp" & Species_common != "Ulva")

## Producers ##
fa_pro_1.0 <- fa_1.0 %>%
  filter(Species_common == "Eelgrass" | Species_common == "Eelgrass diatoms" | Species_common == "Fucus" | Species_common == "Particulate organic matter" | Species_common == "Sugar kelp" | Species_common == "Ulva")

fa_pro_1.0 <- merge(fa_pro_1.0, bimrk, by.x = "ID", by.y = "Biomarker_ID")
fa_pro_1.0 <- cbind(fa_pro_1.0[,c(69:76, 1, 3:67)])
colnames(fa_pro_1.0)[6] <- "Species_common"

## Crabs ##
fa_crb_1.0 <- fa_1.0 %>% 
  filter(Species_common == "Dungeness crab" | Species_common == "Red rock crab" | Species_common == "Helmet crab")

fa_crb_1.0 <- merge(fa_crb_1.0, bimrk, by.x = "ID", by.y = "Biomarker_ID")
fa_crb_1.0 <- cbind(fa_crb_1.0[,c(69:76, 1, 3:67)])
colnames(fa_crb_1.0)[6] <- "Species_common"

## Clams ##
fa_clm_1.0 <- fa_1.0 %>% 
  filter(Species_common == "Butter clam" | Species_common == "Macoma sp." | Species_common == "Pointed Macoma" | Species_common == "Bentnose Macoma")

## Grazers / Epifauna ##
fa_grz_1.0 <- fa_1.0 %>% 
  filter(Species_common == "Idotea" | Species_common == "Limpet")

fa_grz_1.0 <- merge(fa_grz_1.0, bimrk, by.x = "ID", by.y = "Biomarker_ID")
fa_grz_1.0 <- cbind(fa_grz_1.0[,c(69:76, 1, 3:67)])
colnames(fa_grz_1.0)[6] <- "Species_common"
```


I will use and arcsine sqrt transformation 
```{r trans std, echo = FALSE}
## Transformation ##
fa_0.5_trs <- asin(sqrt(fa_0.5[, 3:77]))

fa_all_1.0_trs <- asin(sqrt(fa_1.0[, 3: 67]))
fa_anm_1.0_trs <- asin(sqrt(fa_anm_1.0[, 3:67]))
fa_pro_1.0_trs <- asin(sqrt(fa_pro_1.0[, 10:74]))
fa_crb_1.0_trs <- asin(sqrt(fa_crb_1.0[, 10:74]))
fa_clm_1.0_trs <- asin(sqrt(fa_clm_1.0[, 3:67]))
fa_grz_1.0_trs <- asin(sqrt(fa_grz_1.0[, 10:74]))

## Standardization ##
fa_0.5_trs_std <- scale(fa_0.5_trs, center = FALSE, scale = apply(fa_0.5_trs, 2, max))

fa_all_1.0_trs_std <- scale(fa_all_1.0_trs, center = FALSE, scale = apply(fa_all_1.0_trs, 2, max))
fa_anm_1.0_trs_std <- scale(fa_anm_1.0_trs, center = FALSE, scale = apply(fa_anm_1.0_trs, 2, max))
fa_pro_1.0_trs_std <- scale(fa_pro_1.0_trs, center = FALSE, scale = apply(fa_pro_1.0_trs, 2, max))
fa_crb_1.0_trs_std <- scale(fa_crb_1.0_trs, center = FALSE, scale = apply(fa_crb_1.0_trs, 2, max))
fa_clm_1.0_trs_std <- scale(fa_clm_1.0_trs, center = FALSE, scale = apply(fa_clm_1.0_trs, 2, max))
fa_grz_1.0_trs_std <- scale(fa_grz_1.0_trs, center = FALSE, scale = apply(fa_grz_1.0_trs, 2, max))
```

#### NMDS
NMDS calculations
```{r fa nmds, include=FALSE}
## Calculate distances ##
fa_all_1.0_dist <- vegdist(fa_all_1.0_trs_std, method = "bray")
fa_anm_1.0_dist <- vegdist(fa_anm_1.0_trs_std, method = "bray")
fa_pro_1.0_dist <- vegdist(fa_pro_1.0_trs_std, method = "bray")
fa_crb_1.0_dist <- vegdist(fa_crb_1.0_trs_std, method = "bray")
fa_clm_1.0_dist <- vegdist(fa_clm_1.0_trs_std, method = "bray")
fa_grz_1.0_dist <- vegdist(fa_grz_1.0_trs_std, method = "bray")

fa_0.5_dist <- vegdist(fa_0.5_trs_std, method = "bray")

## nmds ##
fa_all_1.0_mds <- metaMDS(fa_all_1.0_dist)
fa_anm_1.0_mds <- metaMDS(fa_anm_1.0_dist)
fa_pro_1.0_mds <- metaMDS(fa_pro_1.0_dist)
fa_crb_1.0_mds <- metaMDS(fa_crb_1.0_dist)
fa_clm_1.0_mds <- metaMDS(fa_clm_1.0_dist)
fa_grz_1.0_mds <- metaMDS(fa_grz_1.0_dist)

fa_0.5_mds <- metaMDS(fa_0.5_dist, try = 50)
```

#### NMDS examination
FA vectors
```{r fa vector, echo = FALSE, eval = FALSE}
## Crabs vectors ##
vec.crb <- envfit(fa_crb_1.0_mds$points, fa_crb_1.0[, 10:74], perm = 9999)
vec.crb.arrows <- scores(vec.crb, display = "vectors")
scalefactor <- 0.3 * min(max(fa_crb_1.0_mds_dat$NMDS1) - min(fa_crb_1.0_mds_dat$NMDS1), max(fa_crb_1.0_mds_dat$NMDS2) - min(fa_crb_1.0_mds_dat$NMDS2))
vec.crb.arrows <- vec.crb.arrows * scalefactor

vec.crb.dat <- data.frame(vec.crb.arrows)
vec.crb.dat$pvals <- vec.crb$vectors$pvals
vec.crb.dat$FA <- row.names(vec.crb.dat)

vec.crb.dat.sig <- vec.crb.dat %>% 
  filter(pvals < 0.01)
```

#### Multivariate tests
PERMANOVA
```{r permanova, echo = FALSE}
adonis2(fa_crb_1.0_dist ~ Sea_otter_region, data = fa_crb_1.0, permutations = 9999)

fa_clm_1.0 <- merge(fa_clm_1.0, bimrk, by.x = "ID", by.y = "Biomarker_ID")

adonis2(fa_clm_1.0_dist ~ Sea_otter_region, data = fa_clm_1.0, permutations = 9999)
```

PERMDISP: analysis of multivariate homogeneity of group dispersions (variances)
```{r permdisp, echo = FALSE}
crb.disp <- betadisper(fa_crb_1.0_dist, fa_crb_1.0$Sea_otter_region, type = "centroid")
plot(crb.disp)
```

##### NMDS plots
Data prep. Build dataframe from metaMDS output fo easy plotting
```{r plot data, echo = FALSE}
## All data ##
fa_all_1.0_mds_dat <- as.data.frame(scores(fa_all_1.0_mds))
fa_all_1.0_mds_dat$ID <- fa_1.0$ID 
fa_all_1.0_mds_dat$Species_common <- fa_1.0$Species_common
fa_all_1.0_mds_dat <- merge(fa_all_1.0_mds_dat, bimrk[, c(1:4, 7, 9, 10)], by.x = "ID", by.y = "Biomarker_ID")
fa_all_1.0_mds_dat$Species_common <- factor(fa_all_1.0_mds_dat$Species_common, levels = c("Shiner perch", "Snake prickleback", "Staghorn sculpin", "Dungeness crab", "Helmet crab", "Red rock crab", "Dock shrimp", "Macoma sp.", "Bentnose Macoma", "Pointed Macoma", "Butter clam", "Idotea", "Limpet", "Eelgrass", "Eelgrass diatoms", "Fucus", "Particulate organic matter", "Sugar kelp", "Ulva"))

## Animals ##
fa_anm_1.0_mds_dat <- as.data.frame(scores(fa_anm_1.0_mds))
fa_anm_1.0_mds_dat$ID <- fa_anm_1.0$ID 
fa_anm_1.0_mds_dat$Species_common <- fa_anm_1.0$Species_common
fa_anm_1.0_mds_dat <- merge(fa_anm_1.0_mds_dat, bimrk[, c(1:4, 7, 9, 10)], by.x = "ID", by.y = "Biomarker_ID")
fa_anm_1.0_mds_dat$Species_common <- factor(fa_anm_1.0_mds_dat$Species_common, levels = c("Shiner perch", "Snake prickleback", "Staghorn sculpin", "Dungeness crab", "Helmet crab", "Red rock crab", "Dock shrimp", "Macoma sp.", "Bentnose Macoma", "Pointed Macoma", "Butter clam", "Idotea", "Limpet"))

## Producers ##
fa_pro_1.0_mds_dat <- as.data.frame(scores(fa_pro_1.0_mds))
fa_pro_1.0_mds_dat$ID <- fa_pro_1.0$ID 
fa_pro_1.0_mds_dat$Species_common <- fa_pro_1.0$Species_common
fa_pro_1.0_mds_dat <- merge(fa_pro_1.0_mds_dat, bimrk[, c(1:4, 7, 9, 10)], by.x = "ID", by.y = "Biomarker_ID")
fa_pro_1.0_mds_dat$Species_common <- factor(fa_pro_1.0_mds_dat$Species_common, levels = c("Eelgrass", "Eelgrass diatoms", "Fucus", "Particulate organic matter", "Sugar kelp", "Ulva"))

## Crabs ##
fa_crb_1.0_mds_dat <- as.data.frame(scores(fa_crb_1.0_mds))
fa_crb_1.0_mds_dat$ID <- fa_crb_1.0$ID 
fa_crb_1.0_mds_dat$Species_common <- fa_crb_1.0$Species_common
fa_crb_1.0_mds_dat <- merge(fa_crb_1.0_mds_dat, bimrk[, c(1:4, 7, 9, 10)], by.x = "ID", by.y = "Biomarker_ID")
fa_crb_1.0_mds_dat$Species_common <- factor(fa_crb_1.0_mds_dat$Species_common, levels = c("Dungeness crab", "Helmet crab", "Red rock crab"))

## Clams ##
fa_clm_1.0_mds_dat <- as.data.frame(scores(fa_clm_1.0_mds))
fa_clm_1.0_mds_dat$ID <- fa_clm_1.0$ID 
fa_clm_1.0_mds_dat$Species_common <- fa_clm_1.0$Species_common
fa_clm_1.0_mds_dat <- merge(fa_clm_1.0_mds_dat, bimrk[, c(1:4, 7, 9, 10)], by.x = "ID", by.y = "Biomarker_ID")
fa_clm_1.0_mds_dat$Species_common <- factor(fa_clm_1.0_mds_dat$Species_common, levels = c("Butter clam", "Macoma sp." ,"Pointed Macoma", "Bentnose Macoma"))

## Grazers/Epifauna ##
fa_grz_1.0_mds_dat <- as.data.frame(scores(fa_grz_1.0_mds))
fa_grz_1.0_mds_dat$ID <- fa_grz_1.0$ID 
fa_grz_1.0_mds_dat$Species_common <- fa_grz_1.0$Species_common
fa_grz_1.0_mds_dat <- merge(fa_grz_1.0_mds_dat, bimrk[, c(1:4, 7, 9, 10)], by.x = "ID", by.y = "Biomarker_ID")
fa_grz_1.0_mds_dat$Species_common <- factor(fa_grz_1.0_mds_dat$Species_common, levels = c("Idotea", "Limpet"))
```

Plots 
```{r nmds plots, echo = FALSE}
## Color Pallatte ##
pal <- colorRampPalette(brewer.pal(12, "Paired"))

## nmds species all ##
ggplot(fa_all_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common, shape = Species_common), size = 3) +
  scale_color_manual(values = pal(19)) +
  scale_shape_manual(values = rep(c(15:19), 4)) +
  geom_text(x = -0.27, y = -0.35, label = "stress = 0.1652")

## nmds sites and species ##
ggplot(fa_all_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, shape = Place_name, color = Species_common), size = 3) +
  scale_color_manual(values = pal(19)) +
  scale_shape_manual(values = c(0, 15, 16, 17, 18, 6)) +
  geom_text(x = -0.27, y = -0.35, label = "stress = 0.1652")

## nmds sea otter and species ##
ggplot(fa_all_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, shape = Sea_otter_region, color = Species_common), size = 3) +
  scale_color_manual(values = pal(19)) +
  scale_shape_manual(values = c(16, 1)) +
  geom_text(x = -0.27, y = -0.35, label = "stress = 0.1652")

## nmds species animals ##
ggplot(fa_anm_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common, shape = Species_common), size = 3) +
  scale_color_manual(values = pal(13)) +
  scale_shape_manual(values = rep(c(15:19), 3)) +
  geom_text(x = -0.24, y = -0.24, label = "stress = 0.1775")

## nmds sites and species ##
ggplot(fa_anm_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, shape = Place_name, color = Species_common), size = 3) +
  scale_color_manual(values = pal(13)) +
  scale_shape_manual(values = c(0, 15, 16, 17, 18, 6)) +
  geom_text(x = -0.24, y = -0.24, label = "stress = 0.1775")

## nmds sea otter and species ##
ggplot(fa_anm_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, shape = Sea_otter_region, color = Species_common), size = 3) +
  scale_color_manual(values = pal(13)) +
  scale_shape_manual(values = c(16, 1)) +
  geom_text(x = -0.24, y = -0.24, label = "stress = 0.1775")

## nmds species prodecers ##
ggplot(fa_pro_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common, shape = Species_common), size = 3) +
  scale_color_manual(values = pal(19)[14:19]) +
  scale_shape_manual(values = rep(c(15:19), 2)) +
  geom_text(x = -0.40, y = -0.22, label = "stress = 0.1306")

## nmds sites and species ##
ggplot(fa_pro_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common, shape = Place_name), size = 3) +
  scale_color_manual(values = pal(19)[14:19]) +
  scale_shape_manual(values = c(0, 15, 16, 17, 18, 6)) +
  geom_text(x = -0.40, y = -0.22, label = "stress = 0.1306")

## nmds sea otter and species ##
ggplot(fa_pro_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Sea_otter_region, shape = Species_common), size = 3) +
  scale_color_manual(values = c("red", "deepskyblue3")) +
  geom_text(x = -0.40, y = -0.22, label = "stress = 0.1306")

## nmds species crabs ##
ggplot(fa_crb_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common, size = 3))

## nmds sites and species crabs ##
ggplot(fa_crb_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common, shape = Place_name), size = 3) +
  scale_shape_manual(values = c(0, 15, 16, 17, 18, 19))

## nmds sea otter crabs ##
ggplot(fa_crb_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Sea_otter_region, shape = Species_common), size = 3.5) +
  scale_color_manual(values = c("red", "deepskyblue3")) +
  scale_shape_manual(values = c(15, 16, 17)) +
  stat_ellipse(aes(x = NMDS1, y = NMDS2, color = Sea_otter_region)) +
  geom_text(x = -0.25, y = -0.25, label = "stress = 0.1892") +
  geom_text(x = -0.15, y = -0.28, label = "PERMANOVA on sea otter region p = 0.001") +
  geom_segment(data = vec.crb.dat.sig, aes(x = 0, xend = MDS1, y = 0, yend = MDS2)) +
  geom_text(data = vec.crb.dat.sig, aes(x = MDS1,y = MDS2, label = FA, size = 2))

## nmds species clams ##
ggplot(fa_clm_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common), size = 3)

## nmds sites and species clams ##
ggplot(fa_clm_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Species_common, shape = Place_name), size = 3) +
  scale_shape_manual(values = c(0, 15, 16, 17, 18, 19))

## nmds sea otter clams ##
ggplot(fa_clm_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Sea_otter_region, shape = Species_common), size = 3.5) +
  scale_color_manual(values = c("red", "deepskyblue3")) +
  scale_shape_manual(values = c(15:18)) +
  stat_ellipse(aes(x = NMDS1, y = NMDS2, color = Sea_otter_region)) +
  geom_text(x = -0.48, y = -0.25, label = "stress = 0.1258") +
  geom_text(x = -0.23, y = -0.28, label = "PERMANOVA on sea otter region p = 0.005")

## nmds grazers/epifauna ##
ggplot(fa_grz_1.0_mds_dat) +
  geom_point(aes(x = NMDS1, y = NMDS2, color = Place_name, shape = Species_common), size = 3.5) +
  scale_color_manual(values = pal(6))
```



