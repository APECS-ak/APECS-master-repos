---
title: "Stable Isotopes - Seasonality (short version)"
author: "Nicole LaRoche"
date: "2/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Introduction
I am working on sea otter whisker analysis over time from the root to the tip of the whisker.  This includes 29 sea otters as a population between Klawock and Naukati on Prince of Wales Island. Sea otter whiskers were collected from June 26- August 6, 2019. We are looking at seasonality (so I gave each whisker segment a season association), and if there are diet shifts from season to season. A diet shift can be a change in nitrogen (d15N) or carbon (d13C), but generally are considered to be greater than 1‰. 

# Analysis

First, loading programs and files. Otter ID (a numeric, treated as a name in this case) should be read as a factor.

```{r, libraries and data, message= FALSE}
library(ggplot2)
library(dplyr)
library(ggthemes)
library(scales)

#load whisker data
whisker <- read.csv("whiskers.csv")
whisker$OtterID<-as.character(whisker$OtterID)
```


#### Data Cleaning - Temp until final decision is made for the odd otter

Otter 163532 has very odd values, while it is being re-run I have seperated out the values and am going to make the whisker file without this sea otter. I also want the seasons to print in date order, as opposed to alphabetical order

```{r, data cleaning}
whisker<- filter(whisker, OtterID != "163532")

whisker$Season<-factor(whisker$Season , levels=c("Spring", "Summer", "Fall", "Winter"))
```


## Results - Seasons

#### Carbon

```{r, overlay carbon graph by season, echo=FALSE, message=FALSE}
ggplot() +   
  theme_few() +
  geom_density(data=filter(whisker, Season == "Summer"), 
                 aes(x=C), alpha=.5, fill= "darkgoldenrod1") +
  geom_density(data=filter(whisker, Season == "Spring"), 
                 aes(x=C), alpha=.5, fill= "palegreen3") +
  geom_density(data=filter(whisker, Season == "Fall"), 
                 aes(x=C), alpha=.5, fill= "darkorange3") +
  geom_density(data=filter(whisker, Season == "Winter"), 
                 aes(x=C), alpha=.5, fill = "paleturquoise1") +
  labs(x=expression(paste(delta^13, "C" )), y="Kernel Density") 

```


#### Nitrogen

```{r, overlay nitrogen graph by season, echo=FALSE, message=FALSE}
ggplot() +   
  theme_few() +
  geom_density(data=filter(whisker, Season == "Summer"), 
               aes(x=N), alpha=.9, fill= "darkgoldenrod1") +
  geom_density(data=filter(whisker, Season == "Spring"), 
               aes(x=N), alpha=.6, fill= "palegreen3") +
  geom_density(data=filter(whisker, Season == "Fall"), 
               aes(x=N), alpha=.5, fill= "darkorange3") +
  geom_density(data=filter(whisker, Season == "Winter"), 
               aes(x=N), alpha=.4, fill = "paleturquoise1") +
  labs(x=expression(paste(delta^15, "N" )), y="Kernel Density") 
```



The graphs above are ok, but too messy for a paper, and the kernel density is not what I want to talk about, so here are some boxplots of the same data. 

#### Carbon

```{r, boxplot Carbon seasons, echo=FALSE, message=FALSE}
ggplot(data=whisker) +
  geom_boxplot(aes(x=Season, y=C)) +
  labs(y=expression(paste(delta^13, "C" ))) +
  theme_few()
```

#### Nitrogen

```{r, boxplot Nitrogen seasons, echo=FALSE, message=FALSE}
ggplot(data=whisker) +
  geom_boxplot(aes(x=Season, y=N)) +
  labs(y=expression(paste(delta^15, "N" ))) +
  theme_few()
```

Looks like there is very little variation from season to season, with the biggest mean value shifts at about 0.5‰. 


## Stats for Seasons

#### Anova 
```{r, anova seasons, message=FALSE}
cseason.aov <- aov(C~Season*OtterID, data = whisker)
summary(cseason.aov)

nseason.aov <- aov(N~Season*OtterID, data = whisker)
summary(nseason.aov)
```

Season for both C and N are significant. This is not what I would have predicted!

#### Pairwise test for seasons 
```{r, pairwise seasons, message=FALSE}
pairwise.t.test(x=whisker$C, g=whisker$Season, p.adj="none")
pairwise.t.test(x=whisker$N, g=whisker$Season, p.adj="none")
```


Carbon: Spring/Fall, Spring/Summer, Winter/Fall, and Winter/Summer are significant. This doesn't match with how I originally matched the seasons (combining spring and summer, and then fall and winter). 

Nitrogen: Spring/Fall, Spring/Winter, Summer/Fall, and Winter/Summer are significant, which is how I originally matched up the seasons. 


```{r, pairwise bonferroni seasons, message=FALSE}
pairwise.t.test(x=whisker$C, g=whisker$Season, p.adj="bonferroni")
pairwise.t.test(x=whisker$N, g=whisker$Season, p.adj="bonferroni")
```

Using bonferrroni, Spring/Fall are significant for carbon, but nothing else. And all the same Nitrogen seasons remain the same as above.


```{r, pairwise holm, message=FALSE}
pairwise.t.test(x=whisker$C, g=whisker$Season, p.adj="holm")
pairwise.t.test(x=whisker$N, g=whisker$Season, p.adj="holm")
```

This method is generally considered superior to the Bonferroni adjustment, and adds Winter/Fall as stat sig for Carbon.


#### Tukey HSD
```{r, tukey, message=FALSE}
TukeyHSD(aov(C~Season, data=whisker))
TukeyHSD(aov(N~Season, data=whisker))
```

Tukey's gives similar as Bonferroni and Holm. There are significant values here, but really - the main takeaway needs to be that these means are only 0.3-0.5‰. which is VERY SMALL in and ecological sense. 


